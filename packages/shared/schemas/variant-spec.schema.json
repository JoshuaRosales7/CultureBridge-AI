{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "https://culturebridge.ai/schemas/variant-spec.json",
    "title": "VariantSpec",
    "description": "A culturally-adapted storefront variant specification generated by the multi-agent system.",
    "type": "object",
    "required": [
        "variant_id",
        "region",
        "theme_emphasis",
        "flow",
        "modules",
        "copy",
        "risk_flags",
        "audit_score",
        "predicted_lift",
        "rationale",
        "cultural_profile",
        "created_at"
    ],
    "properties": {
        "variant_id": {
            "type": "string",
            "pattern": "^var_[a-zA-Z0-9]{8,}$",
            "description": "Unique identifier for this variant"
        },
        "region": {
            "type": "string",
            "enum": [
                "JP",
                "GT",
                "DE"
            ],
            "description": "Target region code"
        },
        "theme_emphasis": {
            "type": "string",
            "description": "Functional emphasis theme (e.g., 'trust-first', 'efficiency-driven', 'community-validated'). NOT a color or visual stereotype."
        },
        "flow": {
            "type": "array",
            "items": {
                "type": "object",
                "required": [
                    "step_id",
                    "name",
                    "description"
                ],
                "properties": {
                    "step_id": {
                        "type": "string"
                    },
                    "name": {
                        "type": "string"
                    },
                    "description": {
                        "type": "string"
                    },
                    "adaptations": {
                        "type": "array",
                        "items": {
                            "type": "object",
                            "required": [
                                "change",
                                "dimension_driver",
                                "rationale"
                            ],
                            "properties": {
                                "change": {
                                    "type": "string"
                                },
                                "dimension_driver": {
                                    "type": "string"
                                },
                                "rationale": {
                                    "type": "string"
                                }
                            }
                        }
                    },
                    "required_fields": {
                        "type": "array",
                        "items": {
                            "type": "string"
                        }
                    },
                    "validations": {
                        "type": "array",
                        "items": {
                            "type": "string"
                        }
                    }
                }
            },
            "description": "Adapted checkout flow with per-step adaptation rationale"
        },
        "modules": {
            "type": "object",
            "properties": {
                "reviews": {
                    "type": "object",
                    "properties": {
                        "enabled": {
                            "type": "boolean"
                        },
                        "placement": {
                            "type": "string"
                        },
                        "style": {
                            "type": "string"
                        },
                        "adaptation_rationale": {
                            "type": "string"
                        }
                    }
                },
                "guarantees": {
                    "type": "object",
                    "properties": {
                        "enabled": {
                            "type": "boolean"
                        },
                        "types": {
                            "type": "array",
                            "items": {
                                "type": "string"
                            }
                        },
                        "prominence": {
                            "type": "string"
                        },
                        "adaptation_rationale": {
                            "type": "string"
                        }
                    }
                },
                "shipping_info": {
                    "type": "object",
                    "properties": {
                        "enabled": {
                            "type": "boolean"
                        },
                        "placement": {
                            "type": "string"
                        },
                        "detail_level": {
                            "type": "string"
                        },
                        "adaptation_rationale": {
                            "type": "string"
                        }
                    }
                },
                "returns": {
                    "type": "object",
                    "properties": {
                        "enabled": {
                            "type": "boolean"
                        },
                        "prominence": {
                            "type": "string"
                        },
                        "adaptation_rationale": {
                            "type": "string"
                        }
                    }
                },
                "payment_options": {
                    "type": "object",
                    "properties": {
                        "enabled": {
                            "type": "boolean"
                        },
                        "show_installments": {
                            "type": "boolean"
                        },
                        "show_local_methods": {
                            "type": "boolean"
                        },
                        "emphasized_methods": {
                            "type": "array",
                            "items": {
                                "type": "string"
                            }
                        },
                        "adaptation_rationale": {
                            "type": "string"
                        }
                    }
                },
                "social_proof": {
                    "type": "object",
                    "properties": {
                        "enabled": {
                            "type": "boolean"
                        },
                        "type": {
                            "type": "string"
                        },
                        "placement": {
                            "type": "string"
                        },
                        "adaptation_rationale": {
                            "type": "string"
                        }
                    }
                }
            }
        },
        "copy": {
            "type": "object",
            "properties": {
                "cta_primary": {
                    "type": "object",
                    "required": [
                        "text",
                        "rationale"
                    ],
                    "properties": {
                        "text": {
                            "type": "string"
                        },
                        "rationale": {
                            "type": "string"
                        }
                    }
                },
                "cta_secondary": {
                    "type": "object",
                    "required": [
                        "text",
                        "rationale"
                    ],
                    "properties": {
                        "text": {
                            "type": "string"
                        },
                        "rationale": {
                            "type": "string"
                        }
                    }
                },
                "value_proposition": {
                    "type": "object",
                    "required": [
                        "text",
                        "rationale"
                    ],
                    "properties": {
                        "text": {
                            "type": "string"
                        },
                        "rationale": {
                            "type": "string"
                        }
                    }
                },
                "urgency_text": {
                    "type": "object",
                    "required": [
                        "text",
                        "rationale"
                    ],
                    "properties": {
                        "text": {
                            "type": "string"
                        },
                        "rationale": {
                            "type": "string"
                        }
                    }
                },
                "social_proof_text": {
                    "type": "object",
                    "required": [
                        "text",
                        "rationale"
                    ],
                    "properties": {
                        "text": {
                            "type": "string"
                        },
                        "rationale": {
                            "type": "string"
                        }
                    }
                },
                "microcopy": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "required": [
                            "location",
                            "text",
                            "rationale"
                        ],
                        "properties": {
                            "location": {
                                "type": "string"
                            },
                            "text": {
                                "type": "string"
                            },
                            "rationale": {
                                "type": "string"
                            }
                        }
                    }
                }
            }
        },
        "risk_flags": {
            "type": "array",
            "items": {
                "type": "object",
                "required": [
                    "flag_id",
                    "severity",
                    "description",
                    "recommendation"
                ],
                "properties": {
                    "flag_id": {
                        "type": "string"
                    },
                    "severity": {
                        "type": "string",
                        "enum": [
                            "low",
                            "medium",
                            "high",
                            "critical"
                        ]
                    },
                    "description": {
                        "type": "string"
                    },
                    "recommendation": {
                        "type": "string"
                    },
                    "affected_element": {
                        "type": "string"
                    }
                }
            },
            "description": "Bias/stereotype warnings and compliance flags"
        },
        "audit_score": {
            "type": "number",
            "minimum": 0,
            "maximum": 100,
            "description": "Compliance audit score (100 = fully compliant, 0 = high risk)"
        },
        "predicted_lift": {
            "type": "object",
            "required": [
                "metric",
                "baseline",
                "predicted",
                "confidence_level",
                "method",
                "assumptions"
            ],
            "properties": {
                "metric": {
                    "type": "string",
                    "const": "conversion_rate",
                    "description": "The metric being predicted"
                },
                "baseline": {
                    "type": "number",
                    "description": "Baseline conversion rate (e.g., 2.1%)"
                },
                "predicted": {
                    "type": "number",
                    "description": "Predicted conversion rate after adaptation (e.g., 2.8%)"
                },
                "lift_percentage": {
                    "type": "number",
                    "description": "Percentage lift ((predicted - baseline) / baseline * 100)"
                },
                "confidence_level": {
                    "type": "string",
                    "enum": [
                        "low",
                        "medium",
                        "high"
                    ],
                    "description": "Confidence in the prediction"
                },
                "method": {
                    "type": "string",
                    "description": "Explanation of the prediction methodology"
                },
                "assumptions": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    },
                    "description": "List of assumptions underlying the prediction"
                }
            },
            "description": "Predicted conversion lift â€” clearly marked as predictive/simulated"
        },
        "rationale": {
            "type": "string",
            "description": "Overall rationale for the adaptations as a whole"
        },
        "cultural_profile": {
            "$ref": "cultural-behavior-profile.json",
            "description": "The cultural behavior profile used to generate this variant"
        },
        "created_at": {
            "type": "string",
            "format": "date-time"
        }
    },
    "additionalProperties": false
}